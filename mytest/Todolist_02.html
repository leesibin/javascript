<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const input = document.createElement('input')
            const add = document.createElement('button')
            const del = document.createElement('button')
            const div = document.createElement('div')
            

            input.setAttribute('type', 'text')
            add.innerHTML = '추가'
            del.innerHTML = '전체닫기'

            document.body.append(input, add, del, div)

            function localload(){
                    let earr = localStorage.getItem('box')
                    return JSON.parse(earr) ?? []   //없을땐 빈배열로 생성
                }
            function localsave(data){  //date의 내용을 세이트해라
                 let memory = JSON.stringify(data)
                localStorage.setItem('box',memory)
                }

            let data_box = []; 
            let newid = data_box.length
            const  save = localStorage.getItem('todo')
                function todotext (){
                    data_box = localload()
                const div00 = document.createElement('div')
                const checkbox = document.createElement('input')
                const span = document.createElement('span')
                const close = document.createElement('button')

                newid++
                const textv = input.value  //input값 지정하기
                const data = { id: newid, text: textv} //애플리케이션 obj
                
                close.innerHTML = '닫기'
                
                checkbox.setAttribute('type','checkbox')
                span.textContent = textv
                div.appendChild(div00)
                div00.append(checkbox,span,close)
                data_box.push(data)  
                input.value = ''  //입력 후 빈칸
                console.log(data_box)
                // 체크박스
                checkbox.addEventListener('click', (event) => {
                if (event.currentTarget.checked) {   //체크가되면
                    span.style.cssText = 'text-decoration-line: line-through; color: rgba(0, 0, 0, 0.4);'  //스타일 적용
                } else {
                    span.style.cssText = 'text-decoration-line: none;'
                }
                })
                
                //삭제
                close.addEventListener('click', () => {
                    data_box.pop()
                    div.removeChild(div00)
                    localsave(data)
                })
                //전체삭제
                del.addEventListener('click',()=>{
                    div.removeChild(div00)
                    localsave(data)
                })
            }
           
            // 생성
            add.addEventListener('click', todotext)
            // 엔터
            input.addEventListener('keypress', (event) => {
                const ENTER = 13
                if (event.keyCode === ENTER) {
                    todotext();
                }
                
            })
           
          
               
        })
    </script>
</head>

<body>

</body>

</html>